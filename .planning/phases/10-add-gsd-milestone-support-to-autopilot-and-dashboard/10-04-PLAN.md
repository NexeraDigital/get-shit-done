---
phase: 10-add-gsd-milestone-support-to-autopilot-and-dashboard
plan: 04
type: execute
wave: 3
depends_on: ["10-02", "10-03"]
files_modified:
  - autopilot/dashboard/src/components/VictoryScreen.tsx
  - autopilot/dashboard/src/pages/Overview.tsx
autonomous: true

must_haves:
  truths:
    - "When a milestone is shipped, the Overview page transforms into a victory/celebration screen"
    - "Victory screen shows milestone stats, accomplishments, and a 'Start next milestone' prompt"
    - "When all phases are 100% but milestone not formally shipped, just show 100% progress bar with no special prompt"
    - "When no active milestone exists, a 'No active milestone' card suggests running /gsd:new-milestone"
    - "Victory screen only shows the just-shipped milestone's stats, no reference to past milestones"
  artifacts:
    - path: "autopilot/dashboard/src/components/VictoryScreen.tsx"
      provides: "Milestone completion celebration component"
      exports: ["VictoryScreen"]
      min_lines: 40
    - path: "autopilot/dashboard/src/pages/Overview.tsx"
      provides: "Conditional rendering: victory screen, no-milestone card, or normal overview"
      contains: "VictoryScreen"
  key_links:
    - from: "autopilot/dashboard/src/pages/Overview.tsx"
      to: "autopilot/dashboard/src/components/VictoryScreen.tsx"
      via: "conditional import and render"
      pattern: "import.*VictoryScreen"
    - from: "autopilot/dashboard/src/pages/Overview.tsx"
      to: "autopilot/dashboard/src/store/index.ts"
      via: "useDashboardStore selectors for currentMilestone and milestones"
      pattern: "useDashboardStore.*currentMilestone"
---

<objective>
Create the VictoryScreen component and update the Overview page to handle all milestone lifecycle states: active (normal view with milestone header), shipped (victory screen), and none (no-active-milestone empty state).

Purpose: The victory screen is the celebration moment when a milestone ships — it transforms the entire Overview page to show milestone stats, accomplishments, and prompt starting the next milestone. The no-active-milestone card helps users discover the milestone workflow.

Output: New `VictoryScreen.tsx` component and updated `Overview.tsx` with conditional rendering.
</objective>

<execution_context>
@C:/Users/russw/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/russw/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/10-add-gsd-milestone-support-to-autopilot-and-dashboard/10-03-SUMMARY.md
@autopilot/dashboard/src/pages/Overview.tsx
@autopilot/dashboard/src/store/index.ts
@autopilot/dashboard/src/types/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: VictoryScreen component</name>
  <files>
    autopilot/dashboard/src/components/VictoryScreen.tsx
  </files>
  <action>
Create a new `VictoryScreen.tsx` component that displays when a milestone has been shipped.

**Props:**
```typescript
import type { MilestoneInfo } from '../types/index.js';

interface VictoryScreenProps {
  milestone: MilestoneInfo;
}
```

**Layout and content (using Tailwind CSS, matching existing dashboard design language):**

The VictoryScreen is a full-width card that replaces the normal Overview content. Design choices (Claude's discretion per user decision):

1. **Header section** — Large centered celebration area:
   - A green checkmark circle icon (CSS-only, no external icons — consistent with dashboard having no icon library)
   - Large text: "Milestone Shipped!" in bold
   - Subtitle: "{version} {name}" (e.g. "v1.0 MVP")
   - If `shippedDate` exists, show formatted date below subtitle

2. **Stats grid** — 2x2 or 3-across grid showing key metrics:
   - Phases: `{phasesCompleted}/{phaseCount}`
   - Plans: `{planCount}`
   - Date shipped: formatted `shippedDate` or "Just now"
   - Use small card-like boxes with label + value layout

3. **Accomplishments section** — If accomplishments array is non-empty:
   - "Key Accomplishments" heading
   - Bulleted list of accomplishment strings
   - Green checkmark bullets (CSS pseudo-elements or inline SVG)

4. **Next steps prompt** — Bottom section:
   - "Ready for the next milestone?" text
   - Code block or highlighted text showing: `Run /gsd:new-milestone to begin`
   - Use a subtle gray background box with monospace font for the command
   - Per user decision: NO button to trigger it from dashboard (deferred idea)

**Visual style:** Clean, celebratory but not over the top. Use existing color palette (green for success, gray for text). Consider a subtle gradient or slightly different background shade to distinguish from normal cards. No external animations library — CSS transitions only if any animation is used.

**Per user decision:** "Victory screen shows only the just-shipped milestone's stats — no reference to past milestones." The component receives a single MilestoneInfo and does not reference any other milestones.
  </action>
  <verify>
Run `cd autopilot/dashboard && npx tsc --noEmit` — no type errors.
Verify component exports: grep for `export function VictoryScreen` in VictoryScreen.tsx.
  </verify>
  <done>
VictoryScreen component renders milestone celebration with stats, accomplishments, and next-milestone prompt. Uses only Tailwind CSS, no external dependencies.
  </done>
</task>

<task type="auto">
  <name>Task 2: Overview page milestone lifecycle rendering</name>
  <files>
    autopilot/dashboard/src/pages/Overview.tsx
  </files>
  <action>
Update `Overview.tsx` to handle three milestone states with conditional rendering.

**Add imports:**
```typescript
import { VictoryScreen } from '../components/VictoryScreen.js';
import type { MilestoneInfo } from '../types/index.js';
```

**Add store selectors** (alongside existing selectors in the Overview function):
```typescript
const currentMilestone = useDashboardStore((s) => s.currentMilestone);
const milestones = useDashboardStore((s) => s.milestones);
```

**Conditional rendering logic (three states):**

1. **Victory screen state** — When the most recently shipped milestone exists AND currentMilestone is null (meaning no new milestone has started yet after shipping). Check: `milestones.length > 0 && currentMilestone === null && milestones[0]`. This means a milestone was just shipped and the user hasn't started a new one yet.

   Alternatively, if `currentMilestone?.status === 'shipped'`, show victory screen with that milestone.

   The victory screen should render INSTEAD of the normal overview:
   ```tsx
   if (shouldShowVictory) {
     return <VictoryScreen milestone={victoryMilestone} />;
   }
   ```

   IMPORTANT per user decision: "When all phases are 100% but milestone hasn't been formally shipped: just show 100% progress bar, no special prompt." So 100% progress alone does NOT trigger victory. Only a milestone with status === 'shipped' triggers it.

2. **No active milestone state** — When `currentMilestone === null` AND `milestones.length === 0` (no milestones at all — fresh project or between milestones without a shipped history). Show a subtle card above or below the progress bar:
   ```tsx
   <div className="bg-gray-50 rounded-lg border border-gray-200 p-4 text-center">
     <p className="text-sm text-gray-600">No active milestone</p>
     <p className="text-xs text-gray-400 mt-1">
       Run <code className="bg-gray-100 px-1.5 py-0.5 rounded text-xs font-mono">/gsd:new-milestone</code> to define your first milestone
     </p>
   </div>
   ```
   Place this between the project description and the progress bar. The rest of the Overview renders normally (phases, logs, activity).

3. **Normal state (active milestone)** — When `currentMilestone` exists with status 'active'. Render the normal Overview layout unchanged. The PhaseCard component (updated in Plan 03) already handles displaying the milestone header.

**Implementation note:** The no-milestone empty state should be a lightweight inline card, not a separate component. It's a small informational message, not a complex UI.

**State transition handling:** The victory screen state is determined by server data. When the user runs `/gsd:new-milestone`, the server's milestone data changes (new active milestone appears), the 3-second poll picks it up, `currentMilestone` updates from null to the new milestone, and the victory screen is replaced by the normal overview automatically. No explicit dismiss action needed.
  </action>
  <verify>
Run `cd autopilot/dashboard && npx tsc --noEmit` — no type errors.
Verify VictoryScreen import: grep for `VictoryScreen` in Overview.tsx.
Verify milestone selectors: grep for `currentMilestone` in Overview.tsx.
Verify no-milestone card: grep for `No active milestone` in Overview.tsx.
  </verify>
  <done>
Overview page renders victory screen when milestone is shipped, shows no-milestone card for fresh projects, and renders normal overview with milestone-aware PhaseCard for active milestones. All three states handled with correct conditions per user decisions.
  </done>
</task>

</tasks>

<verification>
- `cd autopilot/dashboard && npx tsc --noEmit` compiles without errors
- VictoryScreen component renders milestone stats and accomplishments
- Overview shows VictoryScreen when milestone is shipped
- Overview shows "No active milestone" when no milestones exist
- Overview shows normal layout when milestone is active
- 100% progress WITHOUT shipped status does NOT show victory screen (per user decision)
- Victory screen shows "Run /gsd:new-milestone" prompt, NOT a button (deferred idea)
</verification>

<success_criteria>
- Three milestone states all render correctly: shipped (victory), none (empty state), active (normal)
- Victory screen shows milestone stats, accomplishments, and command prompt
- Victory screen only shows the just-shipped milestone (no historical references)
- No-active-milestone card suggests /gsd:new-milestone command
- 100% progress alone does not trigger victory (only shipped status does)
- All components compile and use Tailwind CSS for styling
</success_criteria>

<output>
After completion, create `.planning/phases/10-add-gsd-milestone-support-to-autopilot-and-dashboard/10-04-SUMMARY.md`
</output>
