# Phase 03.1: Display Claude Console Output to Parent Process - Context

**Gathered:** 2026-02-16
**Status:** Ready for planning

<domain>
## Phase Boundary

Stream SDK output from the Claude Agent SDK `query()` async generator to the parent Node.js process terminal, so users can follow what the autopilot is doing in real time. This covers the streaming pipeline from SDK messages to formatted terminal output and raw log persistence. Does not cover the web dashboard (Phase 5) or notification system (Phase 6).

</domain>

<decisions>
## Implementation Decisions

### Output verbosity
- Default: show everything — full Claude conversation including assistant text, tool calls, and tool results
- Sub-agent output (researchers, planner, executor spawned via Task): stream nested output with visible agent identification
- Full content for large file reads/writes — no truncation, user scrolls if needed
- Two verbosity tiers: --quiet = errors/escalations only, default = full output

### Display formatting
- Rich formatting: spinners for active operations, boxed banner headers for phase/step transitions, color-coded message types
- Sub-agent nesting: color-coded prefix per agent type (e.g., [researcher], [planner]) — no indentation, color differentiation only
- Phase/step transitions: banner-style separators with phase name, step, and timestamp
- Live spinner with context while waiting for SDK responses (e.g., "Executing: /gsd:plan-phase 2" or "Claude is thinking...")

### Filtering and noise
- SDK system messages (init, session ID, metadata): hidden by default, shown only with --verbose
- Retry attempts: visually distinct with yellow/warning styling showing retry count
- Quota usage: show remaining quota (not cost — subscription model). Display after each command completes
- Errors and escalations always visible regardless of verbosity tier

### Log file vs terminal
- Dual output: stream to both terminal (formatted) and log file (raw)
- Log file: raw SDK messages without ANSI colors — machine-readable JSON/text for debugging
- Separate log file (e.g., sdk-output.log) alongside autopilot.log — keeps orchestrator logs clean
- --quiet suppresses terminal streaming to errors only; log file always captures full raw output

### Claude's Discretion
- Exact spinner implementation and animation style
- Color palette for message types and agent prefixes
- Banner header box-drawing characters and layout
- How to surface remaining quota from SDK response metadata

</decisions>

<specifics>
## Specific Ideas

- User is on a subscription plan — cost display is irrelevant, quota remaining is what matters
- The experience should feel like watching Claude Code work, but with phase/step context layered on top

</specifics>

<deferred>
## Deferred Ideas

None — discussion stayed within phase scope

</deferred>

---

*Phase: 03.1-display-claude-console-output-to-parent-node-process-so-users-can-see-whats-happening*
*Context gathered: 2026-02-16*
