# Phase 03.2: Fix Phase Extraction and Dashboard Sub-Phase Visibility - Context

**Gathered:** 2026-02-23
**Status:** Ready for planning

<domain>
## Phase Boundary

Fix `extractPhasesFromContent` in the autopilot orchestrator to merge both ROADMAP.md checklist entries and heading sections, so all phases (including inserted decimal phases like 03.1, 06.1) are visible to the orchestrator and dashboard. Currently the heading parser is a fallback that never runs when the checklist has entries, causing heading-only phases to be invisible.

**Constraint:** No changes to core GSD code (`gsd-tools.js`, workflows, or anything in `~/.claude/get-shit-done/`). All changes stay in the autopilot codebase.

</domain>

<decisions>
## Implementation Decisions

### Extraction strategy
- Merge both checklist and heading sources — checklist first, then add any heading-only phases (currently the heading parser is gated behind `if (phases.length === 0)` and never runs)
- Claude's discretion on merge priority: checklist is authoritative for completion status where it exists, heading-only phases default to not completed
- Always sort extracted phases numerically after merge: 1 < 2 < 3 < 3.1 < 3.2 < 4 < 6 < 6.1 < 7 < 8
- Also extract the `Depends on` field from heading sections — useful for future dependency-aware sequencing
- Detect `(INSERTED)` marker and expose as `inserted: boolean` field on RoadmapPhase
- Silent merge — no warnings when heading-only phases are found. The extraction is the safety net for ROADMAP inconsistency

### Execution ordering
- Decimal phases run immediately after their parent: 3 → 3.1 → 3.2 → 4 (not queued to end)
- Inserted phases always run regardless of parent completion status — they are urgent insertions with their own lifecycle
- Claude's discretion on implicit parent dependency (whether 3.1 requires 3 to be complete)
- Sibling decimals (3.1, 3.2) run sequentially by default; parallel execution allowed if marked in roadmap

### Dashboard display
- Claude's discretion on grouping approach (nested under parent vs flat list with visual distinction)
- All phases (integer and decimal) count equally in progress counter (e.g., "7/11 complete")
- Inserted phases show an INSERTED badge/pill in the dashboard using the `inserted` flag
- Claude's discretion on URL format for phase detail pages (/phases/3.1 vs /phases/3-1)

### Roadmap consistency
- Do NOT modify ROADMAP.md — just make extraction robust to inconsistency
- Claude's discretion on whether to check the Progress table for heading-only phase status, or just default to not completed

</decisions>

<specifics>
## Specific Ideas

- The root cause is `index.ts:55`: `if (phases.length === 0)` gates the heading parser as a fallback instead of a supplement
- Currently missing from dashboard: Phase 03.1 (Display Console Output), Phase 06.1 (Browser Notifications), Phase 8 (Autopilot Claude Command)
- The `RoadmapPhase` type needs new fields: `inserted: boolean`, `dependsOn: string | null`
- Dashboard `PhaseCard` already has `padPhaseDisplay()` that handles decimals — just needs the data

</specifics>

<deferred>
## Deferred Ideas

None — discussion stayed within phase scope

</deferred>

---

*Phase: 03.2-add-sub-phase-support-to-orchestrator-and-dashboard*
*Context gathered: 2026-02-23*
