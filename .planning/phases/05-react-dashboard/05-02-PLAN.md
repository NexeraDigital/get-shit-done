---
phase: 05-react-dashboard
plan: 02
type: execute
wave: 2
depends_on: ["05-01"]
files_modified:
  - autopilot/dashboard/src/App.tsx
  - autopilot/dashboard/src/components/Layout.tsx
  - autopilot/dashboard/src/components/ProgressBar.tsx
  - autopilot/dashboard/src/components/PhaseCard.tsx
  - autopilot/dashboard/src/components/QuestionBadge.tsx
  - autopilot/dashboard/src/components/ActivityFeed.tsx
  - autopilot/dashboard/src/components/LogStream.tsx
  - autopilot/dashboard/src/pages/Overview.tsx
autonomous: true

must_haves:
  truths:
    - "Overview page shows an overall progress bar with percentage"
    - "Overview page shows the current phase as a card with name, description, and active step"
    - "Overview page shows pending questions count with a clickable call-to-action"
    - "Overview page shows a recent activity feed with timestamped entries"
    - "Overview page shows a collapsible live log stream"
    - "Layout shell provides consistent navigation across all pages"
    - "Clicking the current phase card navigates to the phase detail page"
  artifacts:
    - path: "autopilot/dashboard/src/components/Layout.tsx"
      provides: "Shared nav header with links to all pages, Outlet for child routes"
      min_lines: 20
    - path: "autopilot/dashboard/src/pages/Overview.tsx"
      provides: "Main dashboard page composing all overview components"
      min_lines: 30
    - path: "autopilot/dashboard/src/components/ProgressBar.tsx"
      provides: "Overall progress bar (DASH-10)"
      min_lines: 10
    - path: "autopilot/dashboard/src/components/PhaseCard.tsx"
      provides: "Current phase card (DASH-11) with link to phase detail"
      min_lines: 15
    - path: "autopilot/dashboard/src/components/QuestionBadge.tsx"
      provides: "Pending questions CTA (DASH-12)"
      min_lines: 10
    - path: "autopilot/dashboard/src/components/ActivityFeed.tsx"
      provides: "Recent activity feed (DASH-13)"
      min_lines: 15
    - path: "autopilot/dashboard/src/components/LogStream.tsx"
      provides: "Live log stream with auto-scroll (DASH-14)"
      min_lines: 25
  key_links:
    - from: "autopilot/dashboard/src/pages/Overview.tsx"
      to: "autopilot/dashboard/src/store/index.ts"
      via: "useDashboardStore selectors for status, phases, questions, logs, activities"
      pattern: "useDashboardStore"
    - from: "autopilot/dashboard/src/components/Layout.tsx"
      to: "autopilot/dashboard/src/hooks/useSSE.ts"
      via: "useSSE() call at layout level to establish SSE connection once"
      pattern: "useSSE"
    - from: "autopilot/dashboard/src/components/QuestionBadge.tsx"
      to: "/questions/:questionId"
      via: "Link or navigate to question response page"
      pattern: "questions/"
    - from: "autopilot/dashboard/src/components/PhaseCard.tsx"
      to: "/phases/:phaseNumber"
      via: "Link wrapping the card to navigate to phase detail page"
      pattern: "phases/"
---

<objective>
Build the Layout shell and complete Overview page with all dashboard overview components: progress bar, phase card, question badge, activity feed, and log stream.

Purpose: The overview page is the primary landing page users see at localhost:3847. It must give an at-a-glance view of the entire build: progress %, current phase, pending questions needing attention, recent events, and live logs.
Output: A fully functional overview page with real-time data from the Zustand store, wrapped in a navigation layout shared by all pages.
</objective>

<execution_context>
@C:/Users/russw/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/russw/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-react-dashboard/05-RESEARCH.md

# Plan 01 artifacts (types, store, API client, hooks)
@.planning/phases/05-react-dashboard/05-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Layout shell with navigation and SSE connection</name>
  <files>
    autopilot/dashboard/src/components/Layout.tsx
    autopilot/dashboard/src/App.tsx
  </files>
  <action>
**Layout.tsx:**

Create a shared layout component that wraps all pages.

Structure:
- Header with app title "GSD Autopilot" and a connection status indicator (green dot when connected, red when disconnected, using `useDashboardStore(s => s.connected)`)
- Navigation bar with links (using React Router `Link` or `NavLink`) to: Overview ("/"), Logs ("/logs")
- The phase detail and question pages are navigated to from within the app, not from the nav bar
- `Outlet` component from react-router for rendering child routes
- Call `useSSE()` at this level to establish the SSE connection once for the entire app (Pattern 2 from research)
- On mount (useEffect with []), call `fetchStatus()`, `fetchPhases()`, and `fetchQuestions()` to load initial data into the store

Tailwind styling:
- Fixed top header bar with dark background (bg-gray-900 text-white)
- Nav links with active state styling (use NavLink's isActive prop for underline/highlight)
- Main content area with max-w-7xl mx-auto padding
- Connection indicator: small circle (w-2 h-2 rounded-full) with bg-green-400 or bg-red-400

**App.tsx:**

Update the placeholder App.tsx from Plan 01 to use the Layout as a route wrapper:

```tsx
<BrowserRouter>
  <Routes>
    <Route element={<Layout />}>
      <Route index element={<Overview />} />
      <Route path="questions/:questionId" element={<QuestionResponse />} />
      <Route path="phases/:phaseNumber" element={<PhaseDetail />} />
      <Route path="logs" element={<LogViewer />} />
    </Route>
  </Routes>
</BrowserRouter>
```

For QuestionResponse, PhaseDetail, and LogViewer, create minimal placeholder components inline or as simple files that render "Coming soon" -- they will be implemented in Plans 03 and 04. Import Overview from '../pages/Overview'.
  </action>
  <verify>Run `cd autopilot/dashboard && npx tsc --noEmit` -- zero errors. Run `cd autopilot/dashboard && npx vite build` -- succeeds.</verify>
  <done>Layout shell provides consistent header with nav links, connection indicator, and SSE hook. All 4 routes are wired up with Overview as the real page and placeholders for the others.</done>
</task>

<task type="auto">
  <name>Task 2: Build Overview page with all dashboard components</name>
  <files>
    autopilot/dashboard/src/pages/Overview.tsx
    autopilot/dashboard/src/components/ProgressBar.tsx
    autopilot/dashboard/src/components/PhaseCard.tsx
    autopilot/dashboard/src/components/QuestionBadge.tsx
    autopilot/dashboard/src/components/ActivityFeed.tsx
    autopilot/dashboard/src/components/LogStream.tsx
  </files>
  <action>
**ProgressBar.tsx (DASH-10):**
- Props: `progress: number` (0-100)
- Renders a horizontal bar with animated width transition
- Shows percentage text (e.g., "45%") centered or to the right
- Tailwind: outer container (w-full bg-gray-200 rounded-full h-4), inner bar (bg-blue-600 h-4 rounded-full transition-all duration-500), percentage span
- Handle edge cases: 0% shows empty bar, 100% shows full bar with green color (bg-green-500)

**PhaseCard.tsx (DASH-11):**
- Props: `phases: PhaseState[], currentPhase: number, currentStep: string`
- Find the current phase from the phases array by matching currentPhase number
- Wrap the entire card in a `<Link to={`/phases/${currentPhase}`}>` from react-router so clicking the card navigates to the phase detail page. This is the primary navigation path to PhaseDetail -- there is no nav bar link for it.
- Show: phase number, phase name, phase status badge (colored: pending=gray, in_progress=blue, completed=green, failed=red, skipped=yellow)
- Show current step as a highlighted label (e.g., "Step: execute")
- Show step progress: 4 dots/circles for discuss/plan/execute/verify, filled when 'done', pulsing when active
- If no phases, show "No phases loaded" placeholder (no link in this case)
- Tailwind: card with border rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow cursor-pointer, status badge with rounded-full px-2 text-xs

**QuestionBadge.tsx (DASH-12):**
- Props: `questions: QuestionEvent[]`
- Show count of pending questions
- If count > 0: prominent yellow/amber card with bell icon (use Unicode bell or text), count number, "questions need your attention" text, and a Link to the first question (`/questions/${questions[0].id}`)
- If count === 0: subdued green card with "No pending questions" text
- Tailwind: bg-amber-50 border-amber-200 for pending, bg-green-50 border-green-200 for none

**ActivityFeed.tsx (DASH-13):**
- Props: `activities: ActivityItem[]`
- Renders a scrollable list of recent activities, newest first
- Each entry: colored icon/dot based on type (green for completed, blue for started, amber for question, red for error), message text, relative timestamp
- Format timestamp as relative time (e.g., "2m ago", "just now") -- implement a simple `timeAgo(isoString)` helper function inline (compute difference in seconds, return appropriate string). Do not add a dependency like date-fns for this.
- If no activities: "No activity yet" placeholder
- Tailwind: divide-y for separators, max-h-64 overflow-y-auto

**LogStream.tsx (DASH-14):**
- Props: `logs: LogEntry[], maxHeight?: string, collapsible?: boolean`
- Follow Pattern 6 from research exactly for auto-scrolling behavior:
  - useRef on container div, useState for autoScroll (default true)
  - useEffect to scroll to bottom when logs.length changes and autoScroll is true
  - onScroll handler to detect manual scroll-up (disable autoScroll when not at bottom, re-enable when scrolled back to bottom)
- Each log line: timestamp (formatted HH:MM:SS from ISO string), component in brackets, message
- Color-code by level: debug=gray-400, info=gray-700, warn=amber-600, error=red-600, fatal=red-800
- If collapsible is true, wrap in a details/summary element or a toggle button that shows/hides the log container
- Tailwind: font-mono text-xs, container with max-h (use maxHeight prop, default "24rem"), overflow-y-auto, bg-gray-950 text-gray-300 (dark terminal style)

**Overview.tsx:**
- Compose all 5 components above
- Subscribe to Zustand store with individual selectors for each data slice (avoid subscribing to entire store):
  - `const progress = useDashboardStore(s => s.progress)`
  - `const phases = useDashboardStore(s => s.phases)`
  - `const currentPhase = useDashboardStore(s => s.currentPhase)`
  - `const currentStep = useDashboardStore(s => s.currentStep)`
  - `const questions = useDashboardStore(s => s.questions)`
  - `const activities = useDashboardStore(s => s.activities)`
  - `const logs = useDashboardStore(s => s.logs)`
- Layout: CSS grid with responsive columns
  - Top row: ProgressBar (full width)
  - Middle row: PhaseCard (col-span-2 on lg) + QuestionBadge (col-span-1 on lg) side by side
  - Bottom row: ActivityFeed (left half) + LogStream with collapsible=true (right half)
  - On mobile: single column stack
- Tailwind: grid grid-cols-1 lg:grid-cols-3 gap-6 p-6
  </action>
  <verify>
Run `cd autopilot/dashboard && npx tsc --noEmit` -- zero errors.
Run `cd autopilot/dashboard && npx vite build` -- succeeds.
  </verify>
  <done>Overview page renders all 5 dashboard components (DASH-10 through DASH-14) with responsive grid layout, store subscriptions, auto-scrolling logs, question call-to-action linking to question page, and phase card linking to phase detail page.</done>
</task>

</tasks>

<verification>
- `cd autopilot/dashboard && npx tsc --noEmit` passes with zero errors
- `cd autopilot/dashboard && npx vite build` succeeds
- Layout.tsx calls useSSE() and fetches initial data on mount
- Overview.tsx renders ProgressBar, PhaseCard, QuestionBadge, ActivityFeed, LogStream
- All components accept correct props from store selectors
- LogStream implements auto-scroll with scroll detection
- QuestionBadge links to question response page when questions exist
- PhaseCard links to phase detail page for the current phase
</verification>

<success_criteria>
Navigating to the root URL shows a complete overview dashboard with progress bar, current phase card (clickable to phase detail), question badge, activity feed, and collapsible log stream -- all wired to the Zustand store for real-time updates via SSE.
</success_criteria>

<output>
After completion, create `.planning/phases/05-react-dashboard/05-02-SUMMARY.md`
</output>
