# Phase 06.1: Add Browser Notifications - Context

**Gathered:** 2026-02-23
**Status:** Ready for planning

<domain>
## Phase Boundary

Add Web Notifications API and Web Push API support to the React dashboard so users receive browser-level alerts when the autopilot needs attention — even if the dashboard tab isn't focused or closed. This extends the existing notification system (which has console, system, Slack, Teams, webhook adapters) with a client-side browser channel.

</domain>

<decisions>
## Implementation Decisions

### Trigger events
- Fire browser notifications on: question-pending, error escalation, phase-completed, build-complete
- Do NOT fire on: phase-started, step-completed, log-entry (too noisy)
- Question reminders (5-min server-side cycle) do NOT re-fire browser notifications — only the initial question triggers one
- When multiple questions arrive at once, group into single notification (e.g. "3 questions need your attention") rather than individual notifications per question
- Per-type toggles: user can enable/disable notifications per event type (questions, errors, phase-completed, build-complete) independently
- Toggle preferences stored in browser localStorage (not server-side)

### Notification content & behavior
- Title prefix: "GSD Autopilot: " before all notification titles (e.g. "GSD Autopilot: Question needs your input")
- Click action: navigate to relevant page — question notifications open question page, error opens phase detail, completion opens overview
- Auto-dismiss behavior depends on type: questions persist until dismissed (action needed), phase-completed and build-complete auto-dismiss (informational)
- Sound: custom notification sound for questions only (action needed), other types are silent
- Error notifications include the error message in the body (not just "Error in Phase X")
- Build-complete notifications include summary stats (phases completed, duration)
- Use custom GSD icon/logo in notifications for brand recognition

### Permission & opt-in flow
- Request notification permission on first dashboard visit (automatic prompt)
- If denied: show persistent but subtle "Enable notifications" toggle link in header/footer
- No dedicated bell icon or status indicator — just the toggle link
- Per-type toggles accessible from the same UI area

### Background support
- Use Service Worker + Web Push API for notifications even when tab is closed
- Server pushes events to Service Worker using VAPID keys and push subscriptions (web-push npm package)
- Click on Service Worker notification opens new dashboard tab to the relevant page
- Badge: show pending question count on browser tab/icon via Badge API

### Claude's Discretion
- Phase-completed notification detail level (phase name vs phase name + stats)
- Exact notification sound file/tone for questions
- Service Worker cache strategy and update lifecycle
- VAPID key generation and storage approach
- Exact auto-dismiss timeout for informational notifications

</decisions>

<specifics>
## Specific Ideas

- Grouped question notification pattern: "3 questions need your attention" with click navigating to questions list
- Toggle link in header/footer should re-trigger permission prompt if state is "default", or show instructions to enable in browser settings if "denied"
- Badge count should update in real-time as questions are answered

</specifics>

<deferred>
## Deferred Ideas

None — discussion stayed within phase scope

</deferred>

---

*Phase: 06.1-add-browser-notifications-to-alert-users-when-needed*
*Context gathered: 2026-02-23*
